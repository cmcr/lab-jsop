Application for testing javascript object programing
based on book JavaScript Object Programming
By: Martin Rinehart.
Application test different js functions folder: /layouts/lab
===
Application use node js and express js
===
START BY:
>git clone https://github.com/cmcr/lab-jsop.git
/lab-jsop> npm install
/lab-jsop> node server.js
- navigate to http://localhost:3000
- F12 to see the console output
===
if (process.argv.length <= 2) {
    console.log("Usage: " + __filename + " SOME_PARAM");
    process.exit(-1);
}

var param = process.argv[2];

console.log('Param: ' + param);

var objArray = [];
var obj0 = {"name": "pepe0", "age": "30"};
var obj1 = {"name": "pepe1", "age": "31"};
var obj2 = {"name": "pepe2", "age": "32"};
objArray.push(obj0);
objArray.push(obj1);
objArray.push(obj2);

convertToCSV(objArray);

function writeToCsv(dataToWrite, callback) {
    var dataToWrite;
    var fs = require('fs');
    dataToWrite = convertToCSV(dataToWrite);
    fs.writeFile('assets/distanceInfo.csv', dataToWrite, 'utf8', function (err) {
        if (err) {
            console.log('Some error occured - file either not saved or corrupted file saved.');
        } else{
            console.log('It\'s saved!');
        }
        callback("data_saved | assets/distanceInfo.csv")
    });
}

function convertToCSV(objArray) {
    var array = typeof objArray != 'object' ? JSON.parse(objArray) : objArray;
    var str = '';
    var firstObj = objArray[0];
    var keys = Object.keys(firstObj);
    console.log(keys);
    var headLine = '';
    for(var i=0; i<keys.length; i++) {
        headLine += keys[i]+",";
    }
    str += headLine + '\r\n';
    console.log(str);

     for (var i = 0; i < array.length; i++) {
         var line = '';
         for (var index in array[i]) {
             if (line != '') line += ','

             line += array[i][index];
         }
         str += line + '\r\n';
     }
     console.log(str);
    return str;
}
